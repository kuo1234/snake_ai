# åŠ¨æ€è¯¾ç¨‹å¥–åŠ±ç³»ç»Ÿ - è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜

## ğŸ¯ é—®é¢˜è¯Šæ–­

**ç—‡çŠ¶**: Stage 1 (6x6) è®­ç»ƒåï¼ŒAI åœ¨ Stage 2 (8x8) è¿‡åº¦ä¾èµ–è¾¹ç¼˜ç­–ç•¥ï¼Œä¸ç§¯æè¿½é£Ÿç‰©

**æ ¹æœ¬åŸå› **: Stage 1 çš„è¾¹ç¼˜å¥–åŠ±(+0.3)åœ¨ Stage 2 ä»ç„¶ç”Ÿæ•ˆï¼Œå¯¼è‡´ AI "æ‡’æƒ°" - å®æ„¿åœ¨è¾¹ç¼˜æ¸¸è¡æ‹¿å®‰å…¨å¥–åŠ±ï¼Œä¹Ÿä¸æ„¿å†’é™©å»ä¸­å¿ƒåƒé£Ÿç‰©

## âœ… è§£å†³æ–¹æ¡ˆï¼šåŠ¨æ€è¯¾ç¨‹å¥–åŠ±

### æ ¸å¿ƒæ€è·¯
**ä¸åŒé˜¶æ®µï¼Œä¸åŒåŠ¨æœº** - æ ¹æ®åœ°å›¾å¤§å°è‡ªåŠ¨åˆ‡æ¢å¥–åŠ±ç­–ç•¥

### ä¸¤ç§æ¨¡å¼

#### ğŸ¢ ä¿å®ˆæ¨¡å¼ (Stage 1 - 6x6)
**ç›®æ ‡**: å­¦ä¼šåŸºæœ¬ç”Ÿå­˜ï¼Œå»ºç«‹å®‰å…¨æ„è¯†

| å¥–åŠ±é¡¹ | æ•°å€¼ | è¯´æ˜ |
|--------|------|------|
| è¾¹ç¼˜å¥–åŠ± | **+0.3 Ã— multiplier** | é¼“åŠ±è¾¹ç¼˜ç§»åŠ¨ |
| é è¿‘é£Ÿç‰© | **+0.3** | ä½æ€¥è¿«æ€§ |
| è¿œç¦»é£Ÿç‰© | **-0.2** | æ¸©å’Œæƒ©ç½š |
| ç”Ÿå­˜å¥–åŠ± | **+0.2** | é¼“åŠ±è€å¿ƒ |
| é¥¥é¥¿æƒ©ç½š | **æ— ** | å…è®¸æ…¢èŠ‚å¥ |

**ç­–ç•¥**: è¾¹ç¼˜ä¸ºä¸»ï¼Œæ…¢æ…¢é è¿‘é£Ÿç‰©ï¼Œå»ºç«‹å®‰å…¨æ„Ÿ

---

#### ğŸƒ ç§¯ææ¨¡å¼ (Stage 2+ - 8x8+)
**ç›®æ ‡**: ä¸»åŠ¨è¿½é£Ÿï¼Œæé«˜æ•ˆç‡

| å¥–åŠ±é¡¹ | æ•°å€¼ | è¯´æ˜ |
|--------|------|------|
| è¾¹ç¼˜å¥–åŠ± | **ç§»é™¤** | ä¸å†å¥–åŠ±è¾¹ç¼˜ |
| é è¿‘é£Ÿç‰© | **+1.0** | V2 é£æ ¼é«˜æ€¥è¿«æ€§ |
| è¿œç¦»é£Ÿç‰© | **-0.5** | V2 é£æ ¼å¼ºæƒ©ç½š |
| ç”Ÿå­˜å¥–åŠ± | **+0.1** | é™ä½åŸºç¡€å¥–åŠ± |
| é¥¥é¥¿æƒ©ç½š | **-5.0** | 64 æ­¥ä¸åƒé£Ÿç‰©æƒ©ç½š |

**ç­–ç•¥**: ä¸»åŠ¨è¿½é£Ÿç‰©ï¼Œä¸èƒ½æ‹–å»¶ï¼Œå¿…é¡»ç§¯æè¡ŒåŠ¨

---

## ğŸ§ª æµ‹è¯•éªŒè¯ç»“æœ

è¿è¡Œ `test_dynamic_curriculum.py` çš„ç»“æœï¼š

### æµ‹è¯• 1: è¾¹ç¼˜ç§»åŠ¨å¥–åŠ±å¯¹æ¯”

**ä¿å®ˆæ¨¡å¼ (Stage 1)**:
- è¾¹ç¼˜ç§»åŠ¨å¹³å‡å¥–åŠ±: **+0.463**
- âœ… ç¬¦åˆé¢„æœŸ (0.2 ç”Ÿå­˜ + 0.3 è¾¹ç¼˜)

**ç§¯ææ¨¡å¼ (Stage 2)**:
- è¾¹ç¼˜ç§»åŠ¨å¹³å‡å¥–åŠ±: **-0.400**
- âœ… ç¬¦åˆé¢„æœŸ (0.1 ç”Ÿå­˜ - 0.5 è¿œç¦»é£Ÿç‰©)

**å¯¹æ¯”**: 0.463 vs -0.400 = **å·®è· 0.863** ğŸ¯
â†’ Stage 2 ä¸å†é¼“åŠ±è¾¹ç¼˜ï¼Œåè€Œæƒ©ç½šï¼

---

### æµ‹è¯• 2: è¿œç¦»é£Ÿç‰©æƒ©ç½šå¯¹æ¯”

**ä¿å®ˆæ¨¡å¼ (Stage 1)**:
- å¹³å‡å¥–åŠ±: **+0.642**
- æ¸©å’Œæƒ©ç½šï¼Œå…è®¸æ¢ç´¢

**ç§¯ææ¨¡å¼ (Stage 2)**:
- å¹³å‡å¥–åŠ±: **-0.400**
- å¼ºçƒˆæƒ©ç½šï¼Œå¿…é¡»è¿½é£Ÿç‰©

**å¯¹æ¯”**: 0.642 vs -0.400 = **å·®è· 1.042** ğŸ¯
â†’ Stage 2 è¿œç¦»é£Ÿç‰©çš„ä»£ä»·éå¸¸é«˜ï¼

---

### æµ‹è¯• 3: é¥¥é¥¿æƒ©ç½šï¼ˆStage 2 ç‹¬æœ‰ï¼‰

- é¥¥é¥¿é˜ˆå€¼: **64 æ­¥** (board_sizeÂ²)
- è§¦å‘æƒ©ç½š: **-5.0** æ¯æ­¥
- âš ï¸ å¦‚æœ 64 æ­¥å†…ä¸åƒé£Ÿç‰©ï¼ŒæŒç»­å—åˆ° -5.0 æƒ©ç½š
- ğŸ¯ å¼ºåˆ¶ AI å¿…é¡»åœ¨åˆç†æ—¶é—´å†…åƒåˆ°é£Ÿç‰©

---

## ğŸ”§ å®ç°ç»†èŠ‚

### æ–‡ä»¶ä¿®æ”¹

#### 1. `envs/gym_snake_env_v3.py`

**æ–°å¢å‚æ•°**:
```python
curriculum_stage: str = "conservative"  # or "aggressive"
```

**æ–°å¢å˜é‡**:
```python
self.steps_since_food = 0
self.hunger_threshold = board_size * board_size
```

**åŠ¨æ€å¥–åŠ±é€»è¾‘**:
```python
if self.curriculum_stage == "conservative":
    distance_approach_reward = 0.3
    distance_away_penalty = -0.2
    survival_reward = 0.2
    edge_bonus_enabled = True
    hunger_penalty_enabled = False
else:  # aggressive
    distance_approach_reward = 1.0  # V2 style
    distance_away_penalty = -0.5    # V2 style
    survival_reward = 0.1
    edge_bonus_enabled = False      # NO edge bonus!
    hunger_penalty_enabled = True   # Enable hunger timer!
```

#### 2. `snake_ai_ppo_v3.py`

**è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼**:
```python
curriculum_stage = "conservative" if board_size <= 6 else "aggressive"
```

**æ›´æ–°æ‰€æœ‰ç¯å¢ƒåˆ›å»º**:
- `create_v3_model()`
- `evaluate_model()`
- `demo_stage()`

---

## ğŸ“Š æœŸæœ›æ•ˆæœ

### Stage 1 (6x6) - ä¿å®ˆæ¨¡å¼
âœ… å­¦ä¼šè¾¹ç¼˜ç­–ç•¥  
âœ… å»ºç«‹å®‰å…¨æ„è¯†  
âœ… æ…¢èŠ‚å¥ç§¯ç´¯é£Ÿç‰©  
**ç›®æ ‡åˆ†æ•°**: 25+ / 35

### Stage 2 (8x8) - ç§¯ææ¨¡å¼
âœ… **ç§»é™¤è¾¹ç¼˜ä¾èµ–**  
âœ… **ä¸»åŠ¨è¿½é£Ÿç‰©**  
âœ… **é¿å…æ‹–å»¶**ï¼ˆé¥¥é¥¿æƒ©ç½šï¼‰  
âœ… åˆ©ç”¨ Stage 1 å­¦åˆ°çš„é¿é™©æŠ€èƒ½  
**ç›®æ ‡åˆ†æ•°**: 40+ / 63

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. æµ‹è¯•åŠ¨æ€è¯¾ç¨‹ç³»ç»Ÿ
```bash
python test_dynamic_curriculum.py
```

### 2. å®Œæ•´è®­ç»ƒï¼ˆè‡ªåŠ¨åˆ‡æ¢ï¼‰
```bash
python snake_ai_ppo_v3.py --mode train
```
- Stage 1 è‡ªåŠ¨ä½¿ç”¨ä¿å®ˆæ¨¡å¼
- Stage 2+ è‡ªåŠ¨ä½¿ç”¨ç§¯ææ¨¡å¼

### 3. å•ç‹¬è®­ç»ƒæŸé˜¶æ®µ
```bash
# Stage 1 (ä¿å®ˆ)
python snake_ai_ppo_v3.py --mode train --stage 1

# Stage 2 (ç§¯æ)
python snake_ai_ppo_v3.py --mode train --stage 2
```

---

## ğŸ“ ç†è®ºä¾æ®

### 1. èƒ¡èåœä¸æ£å­
- **èƒ¡èåœ** (é è¿‘é£Ÿç‰© +1.0): è®© AI "æƒ³è¦"é£Ÿç‰©
- **æ£å­** (é¥¥é¥¿æƒ©ç½š -5.0): è®© AI "å¿…é¡»"åƒé£Ÿç‰©

### 2. åŠ¨æœºé‡å¡‘
- Stage 1: "è¾¹ç¼˜æ˜¯å®‰å…¨çš„" â†’ å»ºç«‹ä¿¡å¿ƒ
- Stage 2: "é£Ÿç‰©æ˜¯å¿…éœ€çš„" â†’ æ”¹å˜åŠ¨æœº

### 3. è¯¾ç¨‹å­¦ä¹ åŸåˆ™
- å…ˆæ˜“åéš¾
- åˆ†é˜¶æ®µç›®æ ‡
- åŠ¨æ€è°ƒæ•´éš¾åº¦å’Œå¥–åŠ±

---

## ğŸ” æ•…éšœæ’é™¤

### å¦‚æœ Stage 2 ä»ç„¶ä¸å¤Ÿç§¯æ

**æ–¹æ¡ˆ 1**: å¢åŠ é¥¥é¥¿æƒ©ç½š
```python
hunger_penalty = -10.0  # ä» -5.0 å¢åŠ åˆ° -10.0
```

**æ–¹æ¡ˆ 2**: ç¼©çŸ­é¥¥é¥¿é˜ˆå€¼
```python
self.hunger_threshold = board_size * board_size // 2  # 32 æ­¥ for 8x8
```

**æ–¹æ¡ˆ 3**: å¢åŠ è·ç¦»å¥–åŠ±æ€¥è¿«æ€§
```python
distance_approach_reward = 1.5  # ä» 1.0 å¢åŠ 
distance_away_penalty = -1.0    # ä» -0.5 å¢åŠ 
```

### å¦‚æœ Stage 1 å­¦ä¸ä¼šè¾¹ç¼˜ç­–ç•¥

**æ–¹æ¡ˆ 1**: å¢åŠ è¾¹ç¼˜å¥–åŠ±
```python
edge_bonus = 0.5  # ä» 0.3 å¢åŠ 
```

**æ–¹æ¡ˆ 2**: é™ä½è·ç¦»å¥–åŠ±
```python
distance_approach_reward = 0.2  # ä» 0.3 é™ä½
```

---

## ğŸ“ˆ å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | Stage 1 (ä¿å®ˆ) | Stage 2 (ç§¯æ) | å˜åŒ– |
|------|---------------|---------------|------|
| è¾¹ç¼˜å¥–åŠ± | +0.3 | **ç§»é™¤** | -100% |
| é è¿‘é£Ÿç‰© | +0.3 | **+1.0** | +233% |
| è¿œç¦»é£Ÿç‰© | -0.2 | **-0.5** | +150% |
| ç”Ÿå­˜å¥–åŠ± | +0.2 | **+0.1** | -50% |
| é¥¥é¥¿æƒ©ç½š | æ—  | **-5.0** | æ–°å¢ |
| è¾¹ç¼˜ç§»åŠ¨å®æµ‹ | +0.463 | **-0.400** | -187% |

**æ ¸å¿ƒå˜åŒ–**: ä»"é¼“åŠ±å®‰å…¨"åˆ°"å¼ºåˆ¶è¿½é£Ÿ"

---

## ğŸ’¡ åˆ›æ–°ç‚¹

1. **è¯¾ç¨‹æ„ŸçŸ¥å¥–åŠ±**: é¦–æ¬¡åœ¨åŒä¸€ç¯å¢ƒç±»ä¸­å®ç°åŒæ¨¡å¼å¥–åŠ±
2. **è‡ªåŠ¨åˆ‡æ¢**: æ ¹æ® board_size è‡ªåŠ¨é€‰æ‹©æ¨¡å¼ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®
3. **é¥¥é¥¿è®¡æ—¶å™¨**: åˆ›æ–°çš„æ—¶é—´å‹åŠ›æœºåˆ¶ï¼Œé˜²æ­¢æ‹–å»¶
4. **å¹³æ»‘è¿‡æ¸¡**: ä¿ç•™æ ¸å¿ƒæŠ€èƒ½ï¼ˆè½¬å¼¯ã€é¿é™©ï¼‰ï¼Œåªæ”¹å˜åŠ¨æœº

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

### Stage 1 å®Œæˆæ ‡å¿—
- âœ… å¹³å‡åˆ†æ•° â‰¥ 25
- âœ… è¾¹ç¼˜å æ¯” > 40%
- âœ… ç¨³å®šç”Ÿå­˜

### Stage 2 å®Œæˆæ ‡å¿—
- âœ… å¹³å‡åˆ†æ•° â‰¥ 40
- âœ… **è¾¹ç¼˜å æ¯” < 30%** (å…³é”®æŒ‡æ ‡ï¼)
- âœ… **å¹³å‡åƒé£Ÿç‰©é—´éš” < 32 æ­¥** (å…³é”®æŒ‡æ ‡ï¼)
- âœ… ä¸»åŠ¨è¿½é£Ÿç‰©è¡Œä¸º

---

**åˆ›å»ºæ—¶é—´**: 2025-10-26  
**ç‰ˆæœ¬**: Dynamic Curriculum V1.0  
**çŠ¶æ€**: âœ… å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
