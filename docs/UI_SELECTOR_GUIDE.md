# 🎨 圖形化模型選擇器使用指南

## 📋 概述

圖形化模型選擇器讓你可以在 pygame UI 界面中直觀地選擇：
- **AI 模型類型**（Q-learning、PPO V1、PPO V2）
- **具體模型文件**（包括最佳模型和各個 checkpoint）
- **棋盤大小**（6x6、8x8、10x10、12x12）

不需要在命令行輸入參數，全部通過滑鼠點擊完成！

---

## 🚀 快速啟動

### 方法 1：使用批次檔（最簡單）

雙擊運行：
```
run_ui_selector.bat
```

### 方法 2：使用 Python 腳本

```bash
python demo_ui.py
```

### 方法 3：從主選單啟動

```bash
python demo_ai.py
```
然後選擇 **選項 0：使用圖形化界面選擇模型**

---

## 🎮 使用步驟

### 第一步：選擇模型類型

啟動後會顯示模型類型選擇畫面：

```
┌─────────────────────────────────┐
│   選擇 AI 模型類型               │
├─────────────────────────────────┤
│                                  │
│   ┌──────────────────────┐      │
│   │  Q-Learning (3個)    │      │  ← 點擊選擇
│   └──────────────────────┘      │
│                                  │
│   ┌──────────────────────┐      │
│   │  PPO V1 (4個)        │      │  ← 點擊選擇
│   └──────────────────────┘      │
│                                  │
│   ┌──────────────────────┐      │
│   │  PPO V2 (6個)        │      │  ← 點擊選擇
│   └──────────────────────┘      │
│                                  │
│   使用滑鼠點擊選擇               │
└─────────────────────────────────┘
```

**操作說明：**
- 🖱️ 將滑鼠移到按鈕上，按鈕會變亮
- 🖱️ 點擊選擇你想要的模型類型
- ❌ 點擊視窗關閉按鈕可退出

---

### 第二步：選擇具體模型文件

選擇類型後，會顯示該類型下的所有可用模型：

```
┌──────────────────────────────────────────────┐
│   選擇 PPO V2 模型                            │
├──────────────────────────────────────────────┤
│                                               │
│  ┌──────────────────────────────────────┐   │
│  │ ★ best_model.zip (最佳)              │   │  ← 推薦！
│  └──────────────────────────────────────┘   │
│                                               │
│  ┌──────────────────────────────────────┐   │
│  │ ppo_snake_v2_checkpoint_250000_steps │   │
│  └──────────────────────────────────────┘   │
│                                               │
│  ┌──────────────────────────────────────┐   │
│  │ ppo_snake_v2_checkpoint_200000_steps │   │
│  └──────────────────────────────────────┘   │
│                                               │
│  ┌──────────────────────────────────────┐   │
│  │ ppo_snake_v2_checkpoint_150000_steps │   │
│  └──────────────────────────────────────┘   │
│                                               │
│   按 ESC 返回上一步                          │
└──────────────────────────────────────────────┘
```

**操作說明：**
- ⭐ 帶有 **★** 標記的是最佳模型，表現最好
- 🖱️ 點擊選擇你想要測試的模型
- ⌨️ 按 **ESC** 返回模型類型選擇

---

### 第三步：選擇棋盤大小

選擇模型後，會顯示棋盤大小選擇：

```
┌─────────────────────────────────┐
│   選擇棋盤大小                   │
├─────────────────────────────────┤
│                                  │
│   ┌──────────────────────┐      │
│   │  6x6 (簡單)          │      │  ← 適合新手
│   └──────────────────────┘      │
│                                  │
│   ┌──────────────────────┐      │
│   │  8x8 (標準)          │      │  ← 推薦
│   └──────────────────────┘      │
│                                  │
│   ┌──────────────────────┐      │
│   │  10x10 (困難)        │      │  ← 挑戰
│   └──────────────────────┘      │
│                                  │
│   ┌──────────────────────┐      │
│   │  12x12 (極難)        │      │  ← 高手
│   └──────────────────────┘      │
│                                  │
│   按 ESC 返回上一步              │
└─────────────────────────────────┘
```

**操作說明：**
- 🎯 **8x8** 是標準大小，推薦使用
- 📊 不同大小對應不同難度
- ⌨️ 按 **ESC** 返回模型文件選擇

---

### 第四步：開始遊戲

完成選擇後，UI 會自動關閉並啟動遊戲視窗：

```
==================================================
選擇的配置:
  模型類型: ppo_v2
  模型路徑: models/ppo_snake_v2/best_model/best_model.zip
  棋盤大小: 8x8

正在啟動遊戲...
==================================================
```

然後你就可以觀看 AI 玩遊戲了！

---

## 🎯 最佳實踐

### 推薦配置

1. **初次體驗**
   - 模型：PPO V2 → best_model.zip
   - 棋盤：8x8 (標準)
   - 原因：效果最好，穩定性高

2. **對比測試**
   - 先用 PPO V1 → best_model，再用 PPO V2 → best_model
   - 相同棋盤大小
   - 觀察 V2 的改進效果

3. **難度挑戰**
   - 模型：PPO V2 → best_model.zip
   - 棋盤：從 8x8 逐步增大到 12x12
   - 觀察 AI 在更大空間的表現

---

## 📊 模型說明

### Q-Learning 模型
```
snake_ai_*.pkl
```
- 傳統強化學習方法
- 適合較小棋盤（6x6、8x8）
- 訓練速度快，但效果有限

### PPO V1 模型
```
models/ppo_snake/
├── best_model/best_model.zip     ← 推薦
├── ppo_snake_final.zip
├── ppo_snake_checkpoint_400000_steps.zip
└── ppo_snake_checkpoint_200000_steps.zip
```
- 深度強化學習方法
- 平衡性能與穩定性
- 適合中等棋盤（8x8、10x10）

### PPO V2 模型（推薦）
```
models/ppo_snake_v2/
├── best_model/best_model.zip     ← 最推薦！⭐
├── ppo_snake_v2_final.zip
├── ppo_snake_v2_checkpoint_250000_steps.zip
├── ppo_snake_v2_checkpoint_200000_steps.zip
├── ppo_snake_v2_checkpoint_150000_steps.zip
└── ppo_snake_v2_checkpoint_100000_steps.zip
```
- **增強版 PPO**，專門優化防撞
- 特點：
  - ✅ 更少撞到自己身體
  - ✅ 更好的空間意識
  - ✅ 漸進式碰撞懲罰
  - ✅ 困境檢測
- 適合所有棋盤大小

---

## ⌨️ 快捷鍵

### 選擇界面
- **ESC**：返回上一步或退出
- **鼠標點擊**：選擇按鈕
- **關閉按鈕**：退出程序

### 遊戲界面（取決於具體演示模式）
- **ESC**：暫停/退出
- **SPACE**：暫停/繼續
- **方向鍵**：調整遊戲速度（如果支持）

---

## 🔧 技術細節

### UI 組件

**ModelSelector 類**
```python
class ModelSelector:
    """模型選擇器 UI"""
    def run(self):
        # 返回: (model_type, model_path, board_size)
        return self.selected_model_type, \
               self.selected_model_path, \
               self.selected_board_size
```

### 選擇流程

```
開始
  │
  ▼
選擇模型類型
  │
  ├─ Q-Learning
  ├─ PPO V1
  └─ PPO V2
  │
  ▼
選擇具體模型文件
  │
  ├─ best_model.zip
  ├─ final.zip
  └─ checkpoint_*.zip
  │
  ▼
選擇棋盤大小
  │
  ├─ 6x6
  ├─ 8x8
  ├─ 10x10
  └─ 12x12
  │
  ▼
啟動遊戲
```

---

## 🐛 常見問題

### Q1: UI 視窗打不開？

**可能原因：**
- pygame 未安裝或版本過舊

**解決方法：**
```bash
pip install pygame --upgrade
```

### Q2: 沒有可選的模型？

**可能原因：**
- 模型文件不存在
- 路徑不正確

**解決方法：**
```bash
# 訓練模型
python snake_ai_ppo_v2.py --mode train --timesteps 500000

# 或檢查模型目錄
ls models/ppo_snake_v2/
```

### Q3: 選擇後沒反應？

**可能原因：**
- 模型文件損壞
- Python 環境問題

**解決方法：**
```bash
# 檢查模型是否可載入
python -c "from stable_baselines3 import PPO; m = PPO.load('models/ppo_snake_v2/best_model/best_model.zip'); print('OK')"
```

### Q4: PPO 選項不可見？

**可能原因：**
- stable_baselines3 未安裝

**解決方法：**
```bash
pip install stable-baselines3 torch
```

---

## 📈 與命令行模式對比

| 特性 | UI 選擇器 | 命令行模式 |
|------|-----------|-----------|
| **易用性** | ⭐⭐⭐⭐⭐ 滑鼠點擊 | ⭐⭐⭐ 需要輸入數字 |
| **視覺化** | ⭐⭐⭐⭐⭐ 圖形界面 | ⭐⭐ 純文字 |
| **模型選擇** | ⭐⭐⭐⭐⭐ 可看到所有選項 | ⭐⭐⭐ 需要記住路徑 |
| **返回操作** | ⭐⭐⭐⭐⭐ ESC 返回 | ⭐⭐ 需要重新運行 |
| **新手友好** | ⭐⭐⭐⭐⭐ 非常友好 | ⭐⭐⭐ 需要理解選項 |

**結論：** 推薦使用 UI 選擇器！

---

## 🎨 自定義 UI

如果你想修改 UI 外觀，可以編輯 `demo_ai.py` 中的顏色定義：

```python
# UI 顏色定義
COLOR_BG = (20, 20, 30)              # 背景色
COLOR_TITLE = (255, 255, 255)        # 標題色
COLOR_TEXT = (200, 200, 200)         # 文字色
COLOR_BUTTON = (50, 100, 150)        # 按鈕色
COLOR_BUTTON_HOVER = (70, 130, 180)  # 按鈕懸停色
COLOR_BUTTON_SELECTED = (100, 180, 100)  # 按鈕選中色
COLOR_BORDER = (100, 100, 120)       # 邊框色
```

---

## 💡 使用技巧

1. **快速測試**
   ```bash
   # 一鍵啟動
   run_ui_selector.bat
   ```

2. **對比不同模型**
   - 運行一次選擇 PPO V1
   - 再運行一次選擇 PPO V2
   - 觀察差異

3. **測試不同難度**
   - 固定模型
   - 改變棋盤大小
   - 觀察 AI 表現變化

4. **找到最佳配置**
   - 嘗試所有 best_model.zip
   - 對比不同版本
   - 選擇效果最好的

---

## 📝 總結

圖形化模型選擇器提供了：
- ✅ **直觀的用戶界面**
- ✅ **輕鬆的模型選擇**
- ✅ **靈活的配置選項**
- ✅ **新手友好的操作**
- ✅ **快速的測試流程**

開始使用：
```bash
# 方法 1：批次檔
run_ui_selector.bat

# 方法 2：Python 腳本
python demo_ui.py

# 方法 3：主選單
python demo_ai.py  # 然後選擇 0
```

享受圖形化的模型選擇體驗吧！🎮✨
